(function(){"use strict";var e={1152:function(e,l,n){var a=n(9242),t=n(3396);const i=(0,t._)("h1",null,"VMail Inbox",-1),r=(0,t.Uk)(" Loading... ");function o(e,l,n,a,o,c){const s=(0,t.up)("MailTable");return(0,t.wg)(),(0,t.iD)(t.HY,null,[i,((0,t.wg)(),(0,t.j4)(t.n4,null,{default:(0,t.w5)((()=>[(0,t.Wm)(s)])),fallback:(0,t.w5)((()=>[r])),_:1}))],64)}var c=n(7139);const s={class:"buttons"},d=["disabled"],u=["disabled"],m={class:"mail-table"},v=["onClick","checked"],h=["onClick"],f=["onClick"],g=["onClick"],p=["onClick"];function b(e,l,n,a,i,r){const o=(0,t.up)("BulkActionBar"),b=(0,t.up)("MailView"),k=(0,t.up)("ModalView");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",s,[(0,t._)("button",{class:(0,c.C_)(["nav-btn",{active:"inbox"===a.selectedScreen}]),disabled:"inbox"===a.selectedScreen,onClick:l[0]||(l[0]=e=>r.selectScreen("inbox"))},"Inbox",10,d),(0,t._)("button",{class:(0,c.C_)(["nav-btn",{active:"archive"===a.selectedScreen}]),disabled:"archive"===a.selectedScreen,onClick:l[1]||(l[1]=e=>r.selectScreen("archive"))},"Archived",10,u)]),(0,t._)("h1",null,(0,c.zw)(a.emailSelection.emails.size)+" emails selected",1),(0,t.Wm)(o,{emails:r.filteredEmails},null,8,["emails"]),(0,t._)("table",m,[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.filteredEmails,(e=>((0,t.wg)(),(0,t.iD)("tr",{key:e.id,class:(0,c.C_)(["clickable",{read:e.read}])},[(0,t._)("td",null,[(0,t._)("input",{type:"checkbox",onClick:l=>a.emailSelection.toggle(e),checked:a.emailSelection.emails.has(e)},null,8,v)]),(0,t._)("td",{onClick:l=>r.openEmail(e)},(0,c.zw)(e.from),9,h),(0,t._)("td",{onClick:l=>r.openEmail(e)},[(0,t._)("p",null,[(0,t._)("strong",null,(0,c.zw)(e.body),1),(0,t.Uk)(" - "+(0,c.zw)(e.body),1)])],8,f),(0,t._)("td",{class:"date",onClick:l=>r.openEmail(e)},(0,c.zw)(a.format(new Date(e.sentAt),"MMM do yyyy")),9,g),(0,t._)("td",null,[(0,t._)("button",{type:"button",onClick:l=>r.archiveEmail(e)},"Archive",8,p)])],2)))),128))])]),a.openedEmail?((0,t.wg)(),(0,t.j4)(k,{key:0,onCloseModal:l[2]||(l[2]=e=>a.openedEmail=null)},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{email:a.openedEmail,onChangeEmail:r.changeEmail},null,8,["email","onChangeEmail"])])),_:1})):(0,t.kq)("",!0)],64)}var k=n(737),w=n(6265),E=n.n(w);const _=E().create({baseURL:"http://localhost:3000",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});var y={getEmails(){return _.get("/emails")},updateEmail(e){return _.put(`/emails/${e.id}`,e)}},C=n(4870);const S={class:"email-display"},M={class:"mb-0"},x=(0,t.Uk)(" Subject: "),A=["innerHTML"];function O(e,l,n,a,i,r){return(0,t.wg)(),(0,t.iD)("div",S,[(0,t._)("div",null,[(0,t._)("button",{onClick:l[0]||(l[0]=(...e)=>a.toggleArchive&&a.toggleArchive(...e))},(0,c.zw)(n.email.archived?"Move to inbox (e)":"Archive (e)"),1),(0,t._)("button",{onClick:l[1]||(l[1]=(...e)=>a.toggleRead&&a.toggleRead(...e))},(0,c.zw)(n.email.read?"Mark Unread (r)":"Mark Read (r)"),1),(0,t._)("button",{onClick:l[2]||(l[2]=(...e)=>a.goNewer&&a.goNewer(...e))},"Newer (k)"),(0,t._)("button",{onClick:l[3]||(l[3]=(...e)=>a.goOlder&&a.goOlder(...e))},"Older (j)")]),(0,t._)("h2",M,[x,(0,t._)("strong",null,(0,c.zw)(n.email.subject),1)]),(0,t._)("div",null,[(0,t._)("em",null,"From "+(0,c.zw)(n.email.from)+" on "+(0,c.zw)(a.format(new Date(n.email.sentAt),"MMM do yyy")),1)]),(0,t._)("div",{innerHTML:a.marked.parse(n.email.body)},null,8,A)])}var j=n(5068);let z=e=>{let l=l=>{let n=e.find((e=>e.key==l.key));n&&n.fn()};window.addEventListener("keydown",l),(0,t.Jd)((()=>{window.removeEventListener("keydown",l)}))};var R=z,D={setup(e,{emit:l}){let n=()=>{l("changeEmail",{toggleRead:!0,save:!0})},a=()=>{l("changeEmail",{toggleArchive:!0,save:!0,closeModal:!0})},t=()=>{l("changeEmail",{changeIndex:-1})},i=()=>{l("changeEmail",{changeIndex:1})},r=()=>{l("changeEmail",{changeIndex:-1,toggleArchive:!0,save:!0})},o=()=>{l("changeEmail",{changeIndex:1,toggleArchive:!0,save:!0})};return R([{key:"r",fn:n},{key:"e",fn:a},{key:"k",fn:t},{key:"j",fn:i},{key:"[",fn:r},{key:"]",fn:o}]),{format:k.Z,marked:j.TU,toggleRead:n,toggleArchive:a,goNewer:t,goOlder:i}},props:{email:{type:Object,required:!0}}},I=n(89);const U=(0,I.Z)(D,[["render",O]]);var H=U;const T={class:"modal"},Z={class:"modal-card"};function F(e,l,n,a,i,r){return(0,t.wg)(),(0,t.iD)("div",T,[(0,t._)("div",{class:"overlay",onClick:l[0]||(l[0]=e=>a.emit("closeModal"))}),(0,t._)("div",Z,[(0,t.WI)(e.$slots,"default")])])}var L={setup(e,{emit:l}){return R([{key:"Escape",fn:()=>{l("closeModal")}}]),{emit:l}}};const V=(0,I.Z)(L,[["render",F]]);var q=V;const B={class:"bulk-action-bar"},N={class:"checkbox"},W=["checked"],Y={class:"buttons"},P=["disabled"],$=["disabled"],J=["disabled"];function K(e,l,n,a,i,r){return(0,t.wg)(),(0,t.iD)("div",B,[(0,t._)("span",N,[(0,t._)("input",{type:"checkbox",checked:a.allEmailsSelected,class:(0,c.C_)({"partial-check":a.someEmailsSelected}),onClick:l[0]||(l[0]=(...e)=>a.bulkSelect&&a.bulkSelect(...e))},null,10,W)]),(0,t._)("span",Y,[(0,t._)("button",{onClick:l[1]||(l[1]=e=>a.emailSelection.markRead()),disabled:[...a.emailSelection.emails].every((e=>e.read))},"Mark Read",8,P),(0,t._)("button",{onClick:l[2]||(l[2]=e=>a.emailSelection.markUnread()),disabled:[...a.emailSelection.emails].every((e=>!e.read))},"Mark Unread",8,$),(0,t._)("button",{onClick:l[3]||(l[3]=e=>a.emailSelection.archive()),disabled:0===a.numberSelected},"Archive",8,J)])])}let G=(0,C.qj)(new Set);const Q=function(){let e=function(e){G.has(e)?G.delete(e):G.add(e)},l=()=>{G.clear()},n=e=>{e.forEach((e=>{G.add(e)}))},a=e=>{G.forEach((l=>{e(l),y.updateEmail(l)}))},t=()=>a((e=>e.read=!0)),i=()=>a((e=>e.read=!1)),r=()=>{a((e=>e.archived=!0)),l()};return{emails:G,toggle:e,clear:l,addMultiple:n,markRead:t,markUnread:i,archive:r}};var X=Q,ee={setup(e){let l=X(),n=(0,t.Fl)((()=>l.emails.size)),a=(0,t.Fl)((()=>e.emails.length)),i=(0,t.Fl)((()=>n.value===a.value)),r=(0,t.Fl)((()=>n.value>0&&n.value<a.value)),o=()=>{i.value?l.clear():l.addMultiple(e.emails)};return{allEmailsSelected:i,someEmailsSelected:r,bulkSelect:o,emailSelection:l,numberSelected:n}},props:{emails:{type:Array,required:!0}}};const le=(0,I.Z)(ee,[["render",K]]);var ne=le,ae={async setup(){const{data:e}=await y.getEmails();return{emailSelection:X(),format:k.Z,emails:(0,C.iH)(e),openedEmail:(0,C.iH)(null),selectedScreen:(0,C.iH)("inbox")}},components:{MailView:H,ModalView:q,BulkActionBar:ne},computed:{sortEmails(){return this.emails.sort(((e,l)=>e.sentAt<l.sentAt?1:-1))},filteredEmails(){return"inbox"==this.selectedScreen?this.sortEmails.filter((e=>!e.archived)):this.sortEmails.filter((e=>e.archived))}},methods:{selectScreen(e){this.selectedScreen=e,this.emailSelection.clear()},openEmail(e){this.openedEmail=e,e&&(e.read=!0,y.updateEmail(e))},archiveEmail(e){e.archived=!0,y.updateEmail(e)},changeEmail({toggleRead:e,toggleArchive:l,save:n,closeModal:a,changeIndex:t}){let i=this.openedEmail;if(e&&(i.read=!i.read),l&&(i.archived=!i.archived),n&&y.updateEmail(i),a&&(this.openedEmail=null),t){let e=this.filteredEmails,l=e.indexOf(i),n=e[l+t];this.openEmail(n)}}}};const te=(0,I.Z)(ae,[["render",b]]);var ie=te,re={name:"Inbox",components:{MailTable:ie}};const oe=(0,I.Z)(re,[["render",o]]);var ce=oe;(0,a.ri)(ce).mount("#app")}},l={};function n(a){var t=l[a];if(void 0!==t)return t.exports;var i=l[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(l,a,t,i){if(!a){var r=1/0;for(d=0;d<e.length;d++){a=e[d][0],t=e[d][1],i=e[d][2];for(var o=!0,c=0;c<a.length;c++)(!1&i||r>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[c])}))?a.splice(c--,1):(o=!1,i<r&&(r=i));if(o){e.splice(d--,1);var s=t();void 0!==s&&(l=s)}}return l}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,t,i]}}(),function(){n.n=function(e){var l=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(l,{a:l}),l}}(),function(){n.d=function(e,l){for(var a in l)n.o(l,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:l[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)}}(),function(){var e={143:0};n.O.j=function(l){return 0===e[l]};var l=function(l,a){var t,i,r=a[0],o=a[1],c=a[2],s=0;if(r.some((function(l){return 0!==e[l]}))){for(t in o)n.o(o,t)&&(n.m[t]=o[t]);if(c)var d=c(n)}for(l&&l(a);s<r.length;s++)i=r[s],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},a=self["webpackChunkvue_3_gmail_clone"]=self["webpackChunkvue_3_gmail_clone"]||[];a.forEach(l.bind(null,0)),a.push=l.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(1152)}));a=n.O(a)})();
//# sourceMappingURL=app.717814df.js.map